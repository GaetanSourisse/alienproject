pico-8 cartridge // http://www.pico-8.com
version 29
__lua__

function _init()
	alien={x=64,y=113,spr(3)}
	bar={x=64,y=120,spr(35)}
	move_alien=false
	astro1={x=rnd(112),y=(8+rnd(12)),sprite=(4+rnd(5))}
	astro2={x=rnd(112),y=(12+rnd(30)),sprite=(4+rnd(5))}
	astro3={x=rnd(112),y=(30+rnd(60)),sprite=(4+rnd(5))}
	astronautes={astro1,astro2,astro3}
	create_stars()
	explosions={}
end


function _update()
	update_stars()
	if btn(➡️)  then
		if move_alien then
		 bar.x+=2
 	else 
 		bar.x+=2 alien.x+=2
 	end
 end
 if btn(⬅️) then
		if move_alien then
		 bar.x-=2 
		else
			bar.x-=2 alien.x-=2
		end
	end 	
	if (btn(❎)) move_alien=true
	if (move_alien) bounce()
 kill()
	end
	if (btnp(⬇️)) then
	explode(astro1.x+4,astro1.y+4,2)
end 

function _draw()
	cls()
	map(0,0,0,0,128,128)
	spr(3,alien.x,alien.y)
	spr(35,bar.x,bar.y,2,1)
	spr(astro1.sprite,astro1.x,astro1.y)
	spr(astro2.sprite,astro2.x,astro2.y)
	spr(astro3.sprite,astro3.x,astro3.y)
 draw_explosions()
	movement_bar()
	draw_stars()
	message()
end
-->8
-- collision

function collision(a,b)
	if a.x>b.x+8
	or a.y>b.y+8
	or a.x+8<b.x
	or a.y+8<b.y then
		return false
	else
		return true 
	end
end


-->8
-- lancer de l'alien
function update_alien()
	alien.x-=1
	alien.y-=1
end



function launch()
	if btn(❎) and alien.x==bar.x and alien.y==113 then
		update_alien()
	end	 
end

-->8
-- rebond
dx=3
dy=-3
function bounce()
		alien.x += dx
		alien.y += dy
		if alien.x<0
	 or alien.x>120
	 or collision(alien,astro1) 
	 or collision(alien,astro2)
	 or collision(alien,astro3) then
		dx=-dx
		end
		if alien.y<8
	 or collision(alien,bar)
	 or collision(alien,astro1)
	 or collision(alien,astro2)
	 or collision(alien,astro3)  then
		dy=-dy
		end
end








-->8
--mouvement de la barre
function movement_bar()
	if bar.x<0 and not move_alien then
		bar.x=0 alien.x=0
	end
	if bar.x>112 and not move_alien then
	 bar.x=112 alien.x=112
	end
	if bar.x<0 and move_alien then
		bar.x=0
	end
	if bar.x>112 and move_alien then
		bar.x=112
	end
end
-->8
--astronautes

function create_astro()
	new_astro={
		x=60,
		y=56
	}
	add(astronautes,new_astro)
end
-->8
--elimination astro

function kill()
	for astro in all(astronautes) do
		if collision(alien,astro) then
			astro.sprite=37
			astro.x=0
			astro.y=0	
		end
	end
end
-->8
--message gagne  et perdu

function message()
		if astro1.x==0 and astro2.x==0 and astro3.x==0 then
			spr(48,40,64,8,24)
			alien.x=68
			alien.y=55
		end
		if alien.y>128 then
			spr(54,40,64,8,56)
		end
end
-->8
-- animations

--init stars
function create_stars()
	stars={}
	for i=1,20 do 
		new_stars={
			x=rnd(128),
			y=rnd(128),
			col=7,
			speed=1.2,
			}
			add(stars,new_stars)
			end
		end
		
-- update stars
function update_stars()
	for s in all(stars) do
		s.y += s.speed
		if s.y > 128 then 
			s.y=0
			s.x=rnd(128)
	 end
 end 
end 
	
-- update stars
function draw_stars()
 for s in all(stars) do 
 	pset(s.x,s.y,s.col,s.speed)
 	end
 end 
-->8
-- explosions 

function explode(x,y,nb)
	while(nb>0) do 
		explo={}
		explo.x=x
		explo.y=y
		explo.r=6
		ecplo.c=10
		add(explosions,explo)
		nb-=1
		end
	end
   
	
function draw_explosions()
 for e in all(explosions) do 
 	circfill(e.x,e.y,e.r,e.c)
 	e.r-=1
 end 
end 
		

__gfx__
00000000000000000000000011111111111141111111141111114111111114111111411111111411111111111111111111111111111111111111111111111111
00000000000000000000000011111111177777111177777117777711117777711777771111777771111111111111111111111111111111111111111111111111
00700700000000000000000013133313178887111178887117ccc711117ccc711733371111733371111111111111111111111111111111111111111111111111
000770000000000000000000113bbb31177777111177777117777711117777711777771111777771111111111111111111111111111111111111111111111111
00077000066666666666666013b0a0b3116961111f16961f116961111f16961ff16961f111169611111111111111111111111111111111111111111111111111
00700700644444aaaa444446113bbb311f666f1111f666f11f666f1111f666f11f666f1111f666f1111111111111111111111111111111111111111111111111
00000000655555555555555611130311f16161f111161611f16161f111161611116161111f16161f111111111111111111111111111111111111111111111111
00000000666666666666666611113111118181111118181111c1c111111c1c111131311111131311111111111111111111111111111111111111111111111111
00000000000007771111111111111111111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000007771711171111111111111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000007771171711111111111111111110077700000770000000770000077770000777700007777000077770000777700000777700077770000777700
0000000000000777111a111111111111111a11110070770000770000000770000077000000707700007707000077070000770700000077000077000000077000
000000000000077711717111111711111111a1110070770000770000000770000077700000707700007777000077000000770700000077000077000000077000
00000000000007771711171111111111111111110077770000770000000770000077000000707700007700000077000000770700000077000077000000077000
77777777000007771111111111111111111111110070770000777700000770000077770000707700007700000077000000777700007777000077770000077000
77777777000007771111111111111111111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77777777000000000000000006666666666666600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
777777770000000000000000644444aaaa4444460000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000065555555555555560000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000066666666666666660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0b0000b000bbbb0000b00b0000b000b0000b00000b000b0000b0000000bbbb0000bbbb0000bbbb0000bbbb0000bbbb00000b00b0000000000000000000000000
00b00b0000b00b0000b00b0000b000b0000b00000bb00b0000b0000000b00b0000b00b0000b0000000b0000000b00b00000b00b0000000000000000000000000
000bb00000b00b0000b00b0000b0b0b0000b00000b0b0b0000b0000000b00b0000b00b0000bbbb0000bb000000bbbb00000b00b0000000000000000000000000
000bb00000b00b0000b00b0000b0b0b0000b00000b00bb0000b0000000b00b0000b00b0000000b0000b0000000bb0000000b00b0000000000000000000000000
000bb00000b00b0000bbbb0000b0b0b0000b00000b000b0000b0000000b00b0000b00b0000000b0000b0000000b0b00000000000000000000000000000000000
000bb00000bbbb0000bbbb0000bbbbb0000b00000b000b0000bbbb0000bbbb0000bbbb0000bbbb0000bbbb0000b00b00000b00b0000000000000000000000000
__gff__
0000000000000000000000010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
3d15161718193d211a1b1c1d181e1f3d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0f0f0f0f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0f0f0f0f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0f0f0f0f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0f0f0f0f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0f0f0f0a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0f0a0f0a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0f0f0f0f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0f0f0f0f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f0f0f0a0f0f0f0a0f0f0f0a0f0f0f0f0f0f0a0f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f0f0f0f0f0f0f0f0f0f0f0a0f0f0f0f0f0f0f0f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f0f0f0f0f0f0f0a0f0f0a0a0f0f0a0f0f0a0f0f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f0f0f0f0f0a0f0f0f0f0a0f0f0f0f0f0f0f0f0f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f000023000000340000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f0f0f0f0f0f0f0f0f0f0a0f0f0f0f0f0f0f0f0f000023000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f0f0f0f0f0f0f0a0f0f0f0f0f0f0f0f0f0f0f0f000023000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f000023233400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f000023232323000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f000023232323230000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f000023232323230000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000232323232323232323002323232323230000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000023232323230000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
00010000000000000000000357502615032750370502a750320502d2503605036050301502925036050262502225035050221502125033050310501c1502e0502e0501a1501a1501915019150337502a45031450
